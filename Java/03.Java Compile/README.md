- [컴파일이란](#컴파일이란)
- [자바 컴파일 과정](#자바-컴파일-과정)

# 컴파일이란

**컴파일** : 원시코드(소스코드)를 컴퓨터가 이해할 수 있는 목적코드(바이트코드, 기계어)로 바꿔주는 것

목적코드→실행코드로 변환하는 것은 링크라고 함.

**빌드** : 소스코드파일을 하나의 실행파일로 만들어주는 과정. 컴파일+링크 과정을 포함한 실행파일 생성 과정

# 자바 컴파일 과정

![Untitled](Java%20Compile%20cdcec7e94ee44c36af5fda966d2325ef/Untitled.png)

![Untitled](Java%20Compile%20cdcec7e94ee44c36af5fda966d2325ef/Untitled%201.png)

1. 우리가 소스코드(.java)를 작성
2. Java Compiler가 소스파일을 컴파일해서 자바 바이트코드 파일(.class)을 생성함.
   바이트 코드 : 아직 컴퓨터는 읽을 수 없지만 JVM은 이해할 수 있는 코드
3. 바이트 코드를 JVM의 Class Loader에게 전달
4. Class Loader는 Dynamic Loading(동적 로딩)으로 필요한 클래스들을 로딩 및 링크해서 JVM의 메모리인 Runtime Data area(런타임 데이터 영역)에 올린다.
   - **클래스 로더 세부 동작**
     Java는 **런타임 시점에 클래스를 로드하고 링크하는 동적 로딩 방식**을 사용함.
     1. **로드** : 바이트 코드를 메서드 영역에 적재한 후, JVM이 메서드 영역에서 바이트 코드들을 메모리에 저장함.
     2. **링크**
        1. **검증** : 자바 언어 명세(Java Language Specification) 및 JVM 명세에 명시된 대로 구성되어 있는지 검사함.
        2. **준비** : 클래스가 필요로 하는 메모리를 할당하고 데이터 구조를 준비함. (필드, 메서드, 인터페이스 등등)
        3. **분석** : 클래스의 상수 풀 내 모든 심볼릭 레퍼런스를 다이렉트 레퍼런스로 변경함.
     3. **초기화** : 클래스 변수들을 적절한 값으로 초기화함. Static 필드(정적 필드)를 설정된 값으로 초기화 함.
5. **Execution Engine(실행 엔진)**은 JVM 메모리에 올라온 바이트 코드들을 명령어 단위로 하나씩 가져와서 실행함.
   - 실행 엔진 종류는 2가지이다.
   1. **인터프리터** : 바이트 코드 명령어를 하나하나 읽고 해석 후 실행함. 하나하나 실행은 빠르지만 전체 실행이 느림
   2. **JIT 컴파일러**(Just-In-Time Compiler) : 인터프리터가 너무 느려서 생긴 방식. 바이트 코드 전체를 컴파일해서 바이너리 코드로 변경 후 메서드를 바이너리 코드로 직접 실행함.
      JIT 컴파일 과정은 별도의 스레드에서 진행된다. JIT 컴파일러는 기본적으로 메소드의 첫 호출 시점에서는 컴파일하지 않는다. 대신, JVM에게 미리 정의된 `컴파일 임계값`을 넘기는 횟수로 바이트 코드의 특정 영역이 호출되면 JIT 컴파일이 실행된다.
